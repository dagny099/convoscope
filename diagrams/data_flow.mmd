%% End-to-End Data Flow Diagram (Convoscope)

flowchart TD
    A[ðŸ§‘â€ðŸ’» User Input] --> B[ðŸ”Ž Input Validation]
    B --> |Valid| C[ðŸ§  Session State Check]
    B --> |Invalid| D[âŒ User-Friendly Error]

    C --> E[ðŸ¤– LLM Router]
    E --> F{Provider Available?}

    F --> |OpenAI| G[ðŸ”¥ OpenAI API]
    F --> |OpenAI Failed| H[ðŸ§  Anthropic Fallback]
    F --> |All Failed| I[ðŸš¨ Error Handler]

    G --> J[ðŸ§µ Response Processing]
    H --> J
    I --> K[â— User Error Message]

    J --> L[ðŸ”Š Stream to UI]
    J --> M[ðŸ’¾ Save to Conversation Manager]

    M --> N[ðŸ“ File Storage]
    M --> O[ðŸ›Ÿ Auto-save Backup]

    L --> P[ðŸ“º Display to User]
    N --> Q[ðŸ—‚ï¸ Conversation History]
    O --> R[ðŸ§¯ Recovery System]

    style A fill:#e1f5fe
    style P fill:#e8f5e8
    style K fill:#ffebee
    style I fill:#ffebee
